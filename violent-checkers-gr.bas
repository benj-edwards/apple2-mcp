10 DIM PX(23),PY(23),PH(23),PT(23):T=1:S=-1:CX=20:CY=20:VX=0:VY=0:MP=-1
15 FOR I=0 TO 11:PX(I)=4+(I-INT(I/4)*4)*9:PY(I)=3+INT(I/4)*4:PT(I)=2:PH(I)=3:NEXT
20 FOR I=12 TO 23:J=I-12:PX(I)=4+(J-INT(J/4)*4)*9:PY(I)=27+INT(J/4)*4:PT(I)=1:PH(I)=3:NEXT
25 GR:COLOR=4:FOR Y=0 TO 39:HLIN 0,39 AT Y:NEXT
30 COLOR=13:HLIN 0,39 AT 0:HLIN 0,39 AT 39:VLIN 0,39 AT 0:VLIN 0,39 AT 39
35 FOR I=0 TO 23:IF PH(I)<=0 THEN 55
40 X=INT(PX(I)):Y=INT(PY(I)):IF PT(I)=1 THEN COLOR=1:GOTO 50
45 COLOR=6
50 PLOT X,Y:PLOT X+1,Y:PLOT X,Y+1:PLOT X+1,Y+1
55 NEXT I
60 COLOR=15:PLOT CX,CY
65 IF MP>=0 AND (ABS(VX)+ABS(VY)>.3) THEN 200
70 VTAB 22:IF T=1 THEN PRINT "RED: IJKL SPACE";
72 IF T=2 THEN PRINT "BLUE: IJKL SPACE";
75 GET A$:IF A$="I" AND CY>1 THEN CY=CY-1
76 IF A$="K" AND CY<38 THEN CY=CY+1
77 IF A$="J" AND CX>1 THEN CX=CX-1
78 IF A$="L" AND CX<38 THEN CX=CX+1
80 IF A$<>" " THEN 25
85 IF S>=0 THEN 100
90 FOR I=0 TO 23:IF PH(I)<=0 OR PT(I)<>T THEN 95
92 DX=CX-PX(I):DY=CY-PY(I):IF DX*DX+DY*DY<8 THEN S=I:GOTO 25
95 NEXT I:GOTO 25
100 DX=PX(S)-CX:DY=PY(S)-CY:D=SQR(DX*DX+DY*DY):IF D<2 THEN S=-1:GOTO 25
105 VX=DX/D*2:VY=DY/D*2:MP=S:S=-1:GOTO 200
200 PX(MP)=PX(MP)+VX:PY(MP)=PY(MP)+VY:VX=VX*.85:VY=VY*.85
205 IF PX(MP)<2 THEN PX(MP)=2:VX=-VX*.7
206 IF PX(MP)>37 THEN PX(MP)=37:VX=-VX*.7
207 IF PY(MP)<2 THEN PY(MP)=2:VY=-VY*.7
208 IF PY(MP)>37 THEN PY(MP)=37:VY=-VY*.7
210 FOR I=0 TO 23:IF I=MP OR PH(I)<=0 THEN 230
215 DX=PX(MP)-PX(I):DY=PY(MP)-PY(I):D=DX*DX+DY*DY:IF D>12 THEN 230
220 PH(I)=PH(I)-1:VX=-VX*.5:VY=-VY*.5:D=SQR(D):PX(MP)=PX(I)+DX/D*4:PY(MP)=PY(I)+DY/D*4
230 NEXT I:IF ABS(VX)+ABS(VY)>.3 THEN 25
235 MP=-1:VX=0:VY=0:IF T=1 THEN T=2:GOTO 240
238 T=1
240 C1=0:C2=0:FOR I=0 TO 23:IF PH(I)>0 AND PT(I)=1 THEN C1=C1+1
245 IF PH(I)>0 AND PT(I)=2 THEN C2=C2+1
250 NEXT I:IF C1=0 THEN VTAB 23:PRINT "BLUE WINS!":END
255 IF C2=0 THEN VTAB 23:PRINT "RED WINS!":END
260 GOTO 25
